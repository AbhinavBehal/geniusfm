(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{154:function(e,t,n){e.exports=n(354)},159:function(e,t,n){},164:function(e,t,n){},166:function(e,t,n){},176:function(e,t){},198:function(e,t){},200:function(e,t){},354:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(152),c=n.n(s),u=(n(159),n(2)),o=n.n(u),i=n(8),l=n(19),p=n(20),m=n(56),h=n(55),f=n(57),b=(n(164),n(166),function(e){function t(){return Object(l.a)(this,t),Object(m.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"now-playing"},r.a.createElement("h2",null,"now playing"),r.a.createElement("div",{className:"album-art"},r.a.createElement("div",{className:"album-img"},r.a.createElement("img",{alt:"album art",src:this.props.track.image})),r.a.createElement("div",{className:"info"},r.a.createElement("span",null,r.a.createElement("b",null,this.props.track.title)),r.a.createElement("span",null,"by ",r.a.createElement("b",null,this.props.track.artist)),r.a.createElement("span",null,"on ",r.a.createElement("b",null,this.props.track.album))),r.a.createElement("div",{className:"lyrics"},r.a.createElement("span",null,this.props.track.lyrics))))}}]),t}(a.Component)),d=n(153),v=n.n(d),k=function(){function e(t){Object(l.a)(this,e),this.token=t}return Object(p.a)(e,[{key:"request",value:function(){var e=Object(i.a)(o.a.mark(function e(t){var n,a,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.includes("?")?"https://api.genius.com/".concat(t,"&access_token=").concat(this.token):"https://api.genius.com/".concat(t,"?access_token=").concat(this.token),e.next=3,fetch(n);case 3:return a=e.sent,e.next=6,a.json();case 6:if(r=e.sent,console.log(r),!r.error){e.next=10;break}throw new Error("".concat(r.error,": ").concat(r.error_description));case 10:if(200===r.meta.status){e.next=12;break}throw new Error("".concat(r.meta.status,": ").concat(r.meta.message));case 12:return e.abrupt("return",r.response);case 13:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"song",value:function(){var e=Object(i.a)(o.a.mark(function e(t,n){var a,r,s,c,u;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a='search?q="'.concat(t," by ").concat(n,'"'),e.next=3,this.request(a);case 3:return r=e.sent.hits[0].result.api_path.slice(1),e.next=6,this.request(r);case 6:return s=e.sent,c=s.song,e.next=10,this.scrapeLyrics(c.url);case 10:return u=e.sent,e.abrupt("return",Object.assign({lyrics:u},c));case 12:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"referents",value:function(){var e=Object(i.a)(o.a.mark(function e(t){var n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="referents?song_id=".concat(t,"&text_format=html"),e.next=3,this.request(n);case 3:return e.abrupt("return",e.sent.referents);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"scrapeLyrics",value:function(){var e=Object(i.a)(o.a.mark(function e(t){var n,a,r,s;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="https://cors-anywhere.herokuapp.com/".concat(t),e.next=3,fetch(n);case 3:return a=e.sent,e.next=6,a.text();case 6:return r=e.sent,s=v.a.load(r),e.abrupt("return",s(".lyrics").text().trim());case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),e}();function g(){return(g=Object(i.a)(o.a.mark(function e(t){var n,a,r,s,c,u;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://ws.audioscrobbler.com/2.0/?method=user.getrecenttracks&user="+t+"&api_key=ceab0ddfa3c5e0db1ea1d39e720aea8d&format=json");case 2:return n=e.sent,e.next=5,n.json();case 5:if(!(a=e.sent)||!a.error){e.next=9;break}return console.log(a.message),e.abrupt("return");case 9:if((r=a.recenttracks.track[0])["@attr"]&&r["@attr"].nowplaying){e.next=13;break}return console.log("not currently playing anything"),e.abrupt("return");case 13:return s=new k("8JMxsTZnH_D5fDAfKnzzGb5d82Ro7-nH7oLScAppfPVjuLXKZmdp7BUH7pVA0dZG"),e.next=16,s.song(r.name,r.artist["#text"]);case 16:return c=e.sent,e.next=19,s.referents(c.id);case 19:return u=e.sent,e.abrupt("return",{title:c.title,album:c.album.name,artist:c.primary_artist.name,image:r.image[r.image.length-1]["#text"],lyrics:c.lyrics,referents:u});case 21:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var y=function(e){return g.apply(this,arguments)},w=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(m.a)(this,Object(h.a)(t).call(this,e))).usernameSubmitted=function(e){console.log(n.state.value),e.preventDefault(),n.loadInfo()},n.loadInfo=Object(i.a)(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(n.state.value);case 2:t=e.sent,n.setState({submitted:!0,track:t});case 4:case"end":return e.stop()}},e,this)})),n.usernameChanged=function(e){n.setState({value:e.target.value}),""===e.target.value&&n.setState({submitted:!1})},n.state={value:"",submitted:!1,track:null},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"app"},r.a.createElement("h1",null,"genius.fm"),r.a.createElement("form",{className:"user-search",onSubmit:this.usernameSubmitted},r.a.createElement("input",{type:"text",placeholder:"your last.fm username",onChange:this.usernameChanged})),r.a.createElement("div",{className:"container ".concat(this.state.submitted?"move-up":"")},this.state.submitted&&r.a.createElement(b,{track:this.state.track})))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(w,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[154,2,1]]]);
//# sourceMappingURL=main.7d3cf1f0.chunk.js.map